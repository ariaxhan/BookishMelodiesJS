{"ast":null,"code":"import{useEffect,useState}from'react';import SpotifyWebApi from\"spotify-web-api-js\";// Spotify Authentication Constants and Functions\nexport const authEndpoint=\"https://accounts.spotify.com/authorize\";const redirectUri=\"http://localhost:3001/\";const clientId=\"01c9f82ca3e348e2adc1d98eded52db1\";const scopes=[\"user-read-currently-playing\",\"user-read-recently-played\",\"user-read-playback-state\",\"user-top-read\",\"user-modify-playback-state\"];// Function to extract token from URL\nexport const getTokenFromUrl=()=>{return window.location.hash.substring(1).split(\"&\").reduce((initial,item)=>{let parts=item.split(\"=\");initial[parts[0]]=decodeURIComponent(parts[1]);return initial;},{});};// Spotify login URL with required scopes\nexport const loginUrl=\"\".concat(authEndpoint,\"?client_id=\").concat(clientId,\"&redirect_uri=\").concat(redirectUri,\"&scope=\").concat(scopes.join(\"%20\"),\"&response_type=token&show_dialog=true\");// Spotify Authentication Component\nconst spotify=new SpotifyWebApi();function Authenticate(){const[token,setToken]=useState();useEffect(()=>{// Extract the token from the URL\nconst hash=getTokenFromUrl();window.location.hash=\"\";// Clear the hash from the URL\nconst _token=hash.access_token;if(_token){setToken(_token);// Set the token in the state\nspotify.setAccessToken(_token);// Set the token for Spotify API\n// Send the token to the Express server\nfetch('http://localhost:3003/set-spotify-token',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({spotifyToken:_token})}).then(response=>response.json()).then(data=>{console.log(\"Token sent to the server:\",data.message);}).catch(error=>{console.error(\"Error sending token to server:\",error);});}},[]);return null;}export default Authenticate;","map":{"version":3,"names":["useEffect","useState","SpotifyWebApi","authEndpoint","redirectUri","clientId","scopes","getTokenFromUrl","window","location","hash","substring","split","reduce","initial","item","parts","decodeURIComponent","loginUrl","concat","join","spotify","Authenticate","token","setToken","_token","access_token","setAccessToken","fetch","method","headers","body","JSON","stringify","spotifyToken","then","response","json","data","console","log","message","catch","error"],"sources":["/Users/ariahan/Library/Mobile Documents/com~apple~CloudDocs/BookishMelodiesJS/client/src/components/Authenticate.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport SpotifyWebApi from \"spotify-web-api-js\";\n\n// Spotify Authentication Constants and Functions\nexport const authEndpoint = \"https://accounts.spotify.com/authorize\";\nconst redirectUri = \"http://localhost:3001/\";\nconst clientId = \"01c9f82ca3e348e2adc1d98eded52db1\";\n\nconst scopes = [\n  \"user-read-currently-playing\",\n  \"user-read-recently-played\",\n  \"user-read-playback-state\",\n  \"user-top-read\",\n  \"user-modify-playback-state\",\n];\n\n// Function to extract token from URL\nexport const getTokenFromUrl = () => {\n  return window.location.hash\n    .substring(1)\n    .split(\"&\")\n    .reduce((initial, item) => {\n      let parts = item.split(\"=\");\n      initial[parts[0]] = decodeURIComponent(parts[1]);\n      return initial;\n    }, {});\n};\n\n// Spotify login URL with required scopes\nexport const loginUrl = `${authEndpoint}?client_id=${clientId}&redirect_uri=${redirectUri}&scope=${scopes.join(\n  \"%20\"\n)}&response_type=token&show_dialog=true`;\n\n// Spotify Authentication Component\nconst spotify = new SpotifyWebApi();\n\nfunction Authenticate() {\n    const [token, setToken] = useState();\n\n    useEffect(() => {\n        // Extract the token from the URL\n        const hash = getTokenFromUrl();\n        window.location.hash = \"\"; // Clear the hash from the URL\n        const _token = hash.access_token;\n\n        if (_token) {\n            setToken(_token); // Set the token in the state\n            spotify.setAccessToken(_token); // Set the token for Spotify API\n\n            // Send the token to the Express server\n            fetch('http://localhost:3003/set-spotify-token', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ spotifyToken: _token }),\n            })\n            .then(response => response.json())\n            .then(data => {\n                console.log(\"Token sent to the server:\", data.message);\n            })\n            .catch(error => {\n                console.error(\"Error sending token to server:\", error);\n            });\n        }\n    }, []);\n\n    return null; \n}\n\nexport default Authenticate;\n"],"mappings":"AAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,aAAa,KAAM,oBAAoB,CAE9C;AACA,MAAO,MAAM,CAAAC,YAAY,CAAG,wCAAwC,CACpE,KAAM,CAAAC,WAAW,CAAG,wBAAwB,CAC5C,KAAM,CAAAC,QAAQ,CAAG,kCAAkC,CAEnD,KAAM,CAAAC,MAAM,CAAG,CACb,6BAA6B,CAC7B,2BAA2B,CAC3B,0BAA0B,CAC1B,eAAe,CACf,4BAA4B,CAC7B,CAED;AACA,MAAO,MAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CACnC,MAAO,CAAAC,MAAM,CAACC,QAAQ,CAACC,IAAI,CACxBC,SAAS,CAAC,CAAC,CAAC,CACZC,KAAK,CAAC,GAAG,CAAC,CACVC,MAAM,CAAC,CAACC,OAAO,CAAEC,IAAI,GAAK,CACzB,GAAI,CAAAC,KAAK,CAAGD,IAAI,CAACH,KAAK,CAAC,GAAG,CAAC,CAC3BE,OAAO,CAACE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAGC,kBAAkB,CAACD,KAAK,CAAC,CAAC,CAAC,CAAC,CAChD,MAAO,CAAAF,OAAO,CAChB,CAAC,CAAE,CAAC,CAAC,CAAC,CACV,CAAC,CAED;AACA,MAAO,MAAM,CAAAI,QAAQ,IAAAC,MAAA,CAAMhB,YAAY,gBAAAgB,MAAA,CAAcd,QAAQ,mBAAAc,MAAA,CAAiBf,WAAW,YAAAe,MAAA,CAAUb,MAAM,CAACc,IAAI,CAC5G,KACF,CAAC,yCAAuC,CAExC;AACA,KAAM,CAAAC,OAAO,CAAG,GAAI,CAAAnB,aAAa,CAAC,CAAC,CAEnC,QAAS,CAAAoB,YAAYA,CAAA,CAAG,CACpB,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGvB,QAAQ,CAAC,CAAC,CAEpCD,SAAS,CAAC,IAAM,CACZ;AACA,KAAM,CAAAU,IAAI,CAAGH,eAAe,CAAC,CAAC,CAC9BC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,EAAE,CAAE;AAC3B,KAAM,CAAAe,MAAM,CAAGf,IAAI,CAACgB,YAAY,CAEhC,GAAID,MAAM,CAAE,CACRD,QAAQ,CAACC,MAAM,CAAC,CAAE;AAClBJ,OAAO,CAACM,cAAc,CAACF,MAAM,CAAC,CAAE;AAEhC;AACAG,KAAK,CAAC,yCAAyC,CAAE,CAC7CC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,YAAY,CAAET,MAAO,CAAC,CACjD,CAAC,CAAC,CACDU,IAAI,CAACC,QAAQ,EAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAI,CACVC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAEF,IAAI,CAACG,OAAO,CAAC,CAC1D,CAAC,CAAC,CACDC,KAAK,CAACC,KAAK,EAAI,CACZJ,OAAO,CAACI,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CAC1D,CAAC,CAAC,CACN,CACJ,CAAC,CAAE,EAAE,CAAC,CAEN,MAAO,KAAI,CACf,CAEA,cAAe,CAAArB,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}